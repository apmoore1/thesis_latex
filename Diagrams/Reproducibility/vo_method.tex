\begin{tikzpicture}[
    feature/.style={circle, draw, radius=0.05},
    vector/.style={rectangle, draw, minimum height=1cm},
    arrow_pointer/.style={decoration={markings,mark=at position 1 with %
    {\arrow[scale=3,>=stealth]{>}}},postaction={decorate}}]
    
    % Left Context
    \node[feature](feat1){};
    \node[feature, below=.2 of feat1](feat2){};
    \node[feature, above=.2 of feat1](feat0){};
	\node[vector, fit=(feat0)(feat1)(feat2)] (vec0) {};
	\node[below=.1 of vec0] (x0) {$w_0$};
	
	\node[feature, right=.5 of vec0](feat4){};
    \node[feature, below=.2 of feat4](feat5){};
    \node[feature, above=.2 of feat4](feat3){};
	\node[vector, fit=(feat4)(feat3)(feat5)] (vec1) {};
	\node[below=.1 of vec1] (x1) {$w_1$};
	
	\node[right=.5 of vec1](dot0){$\dots$};
	
	\node[feature, right=.5of dot0](feat7){};
    \node[feature, below=.2 of feat7](feat8){};
    \node[feature, above=.2 of feat7](feat6){};
	\node[vector, fit=(feat7)(feat6)(feat8)] (vec2) {};
	\node[below=.1 of vec2] (x2) {$w_l$};
	
	\node[below left=.1 of x0] (line0) {};
	\node[below right=.1 of x2] (line1) {};
	\draw [|-|] (line0) -- (line1)  node[pos=0.5, below=0.1]{Left Context};
	
	% Target Context
	\node[feature, right=.8 of vec2](feat10){};
    \node[feature, below=.2 of feat10](feat11){};
    \node[feature, above=.2 of feat10](feat9){};
	\node[vector, fit=(feat10)(feat9)(feat11)] (vec3) {};
	\node[below=.1 of vec3] (x3) {$w_{l+1}$};
	
	\node[right=.5 of vec3](dot1){$\dots$};
	
	\node[feature, right=.5 of dot1](feat13){};
    \node[feature, below=.2 of feat13](feat14){};
    \node[feature, above=.2 of feat13](feat12){};
	\node[vector, fit=(feat13)(feat12)(feat14)] (vec4) {};
	\node[below=.1 of vec4] (x4) {$w_{r-1}$};
	
	\node[below left=.1 of x3] (line2) {};
	\node[below right=.1 of x4] (line3) {};
	\draw [|-|] (line2) -- (line3)  node[pos=0.5, below=0.1]{Target Context};
	
	% Right Context
	\node[feature, right=.8 of vec4](feat16){};
    \node[feature, below=.2 of feat16](feat17){};
    \node[feature, above=.2 of feat16](feat15){};
	\node[vector, fit=(feat16)(feat15)(feat17)] (vec5) {};
	\node[below=.1 of vec5] (x5) {$w_r$};
	
	\node[right=.5 of vec5](dot2){$\dots$};
	
	\node[feature, right=.5 of dot2](feat19){};
    \node[feature, below=.2 of feat19](feat20){};
    \node[feature, above=.2 of feat19](feat18){};
	\node[vector, fit=(feat19)(feat18)(feat20)] (vec6) {};
	\node[below=.1 of vec6] (x6) {$w_{n-1}$};
	
	\node[feature, right=.5 of vec6](feat22){};
    \node[feature, below=.2 of feat22](feat23){};
    \node[feature, above=.2 of feat22](feat21){};
	\node[vector, fit=(feat22)(feat21)(feat23)] (vec7) {};
	\node[below=.1 of vec7] (x7) {$w_n$};
	
	\node[below left=.1 of x5] (line4) {};
	\node[below right=.1 of x7] (line5) {};
	\draw [|-|] (line4) -- (line5)  node[pos=0.5, below=0.1]{Right Context};
	
	\node[below=.5 of line0] (line6) {};
	\node[below=.5 of line5] (line7) {};
	\draw [|-|] (line6) -- (line7)  node[pos=0.5, below=0.1]{\textbf{Full Context}};
	
	\node[rectangle, draw, minimum width=3em, above=1.9, fit={(vec0.west) (vec7.east)}, minimum height = 1cm, inner ysep=0pt, label={center:Pooling (Max, Min, Prod, Std, Avg)}] (pooling) {};
	
	% Arrows for the context to the pooling layer
	% Left context
	\node[above=.3 of dot0] (top_dot0) {};
	\node[above=1.2 of dot0] (top_top_dot0) {};
	\draw [arrow_pointer] (top_dot0) -- (top_top_dot0);
	
	% Center context
	\node[above=.3 of dot1] (top_dot1) {};
	\node[above=1.2 of dot1] (top_top_dot1) {};
	\draw [arrow_pointer] (top_dot1) -- (top_top_dot1);
	
	% Right context
	\node[above=.3 of dot2] (top_dot2) {};
	\node[above=1.2 of dot2] (top_top_dot2) {};
	\draw [arrow_pointer] (top_dot2) -- (top_top_dot2);
	
	\node[rectangle, draw, minimum width=3em, above=3.8, fit={(vec0.west) (vec7.east)}, minimum height = 1cm, inner ysep=0pt, label={center:SVM}] (svm) {};
	\draw [arrow_pointer] (pooling) -- (svm);
\end{tikzpicture}

