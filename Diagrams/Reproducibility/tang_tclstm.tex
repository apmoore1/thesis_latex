\resizebox{11.0cm}{!}{%
\begin{tikzpicture}[
    feature/.style={circle, draw, radius=0.05},
    vector/.style={rectangle, draw, minimum height=1cm},
    lstm_node/.style={rectangle, draw},
    arrow_pointer/.style={decoration={markings,mark=at position 1 with %
    {\arrow[scale=1,>=stealth]{>}}},postaction={decorate}}]
    
    % Left Context
    \node[feature](feat1){};
    \node[feature, below=.2 of feat1](feat2){};
    \node[feature, above=.2 of feat1](feat0){};
	\node[vector, fit=(feat0)(feat1)(feat2)] (vec0) {};
	\node[below=.1 of vec0] (x0) {$w_0$};
	
	\node[feature, below=2 of feat1](target1){};
    \node[feature, below=.2 of target1](target2){};
    \node[feature, above=.2 of target1](target0){};
	\node[vector, fit=(target0)(target1)(target2)] (target_vec0) {};
	\node[below=.1 of target_vec0] (t0) {$t$};
	% LSTM 0
	\node[lstm_node, above=1.5 of feat1](lstm0){LSTM};
	\draw [arrow_pointer] (vec0) -- (lstm0);
	
	\node[right=1 of feat1](dot0){$\dots$};
	
	\node[feature, right=1 of dot0](feat4){};
    \node[feature, below=.2 of feat4](feat5){};
    \node[feature, above=.2 of feat4](feat3){};
	\node[vector, fit=(feat4)(feat3)(feat5)] (vec1) {};
	\node[below=.1 of vec1] (x1) {$w_l$};
	
	\node[feature, below=2 of feat4](target4){};
    \node[feature, below=.2 of target4](target5){};
    \node[feature, above=.2 of target4](target3){};
	\node[vector, fit=(target3)(target4)(target5)] (target_vec1) {};
	\node[below=.1 of target_vec1] (t1) {$t$};
	% LSTM 1
	\node[lstm_node, above=1.5 of feat4](lstm1){LSTM};
	\draw [arrow_pointer] (vec1) -- (lstm1);
	
	% Arrows between LSTMs
	\node[right=.5 of lstm0] (lstm0_left_mid) {};
	\node[left=.5 of lstm1] (lstm0_right_mid) {};
	\draw [arrow_pointer] (lstm0) -- (lstm0_left_mid) node[pos=0.5, below=0.1]{$h_1$};
	\draw[dotted](lstm0_left_mid) -- (lstm0_right_mid);
	\draw [arrow_pointer] (lstm0_right_mid) -- (lstm1) node[pos=0.5, below=0.1]{$h_{l-1}$};
	
	
	
	\node[feature, right=1.2 of feat4](feat7){};
    \node[feature, below=.2 of feat7](feat8){};
    \node[feature, above=.2 of feat7](feat6){};
	\node[vector, fit=(feat7)(feat6)(feat8)] (vec2) {};
	\node[below=.1 of vec2] (x2) {$w_{l+1}$};
	
	\node[feature, below=2 of feat7](target7){};
    \node[feature, below=.2 of target7](target8){};
    \node[feature, above=.2 of target7](target6){};
	\node[vector, fit=(target6)(target7)(target8)] (target_vec2) {};
	\node[below=.1 of target_vec2] (t2) {$t$};
	
	\node[right=1 of feat7](dot1){$\dots$};
	% LSTM 2
	\node[lstm_node, above=1.5 of feat7](lstm2){LSTM};
	\draw [arrow_pointer] (vec2) -- (lstm2);
	\draw [arrow_pointer] (lstm1) -- (lstm2) node[pos=0.5, below=0.1]{$h_l$};
	
	\node[feature, right=1 of dot1](feat10){};
    \node[feature, below=.2 of feat10](feat11){};
    \node[feature, above=.2 of feat10](feat9){};
	\node[vector, fit=(feat10)(feat9)(feat11)] (vec3) {};
	\node[below=.1 of vec3] (x3) {$w_{r-1}$};
	
	\node[feature, below=2 of feat10](target10){};
    \node[feature, below=.2 of target10](target11){};
    \node[feature, above=.2 of target10](target9){};
	\node[vector, fit=(target9)(target10)(target11)] (target_vec3) {};
	\node[below=.1 of target_vec3] (t3) {$t$};
	
	% LSTM 3
	\node[lstm_node, above=1.5 of feat10](lstm3){LSTM};
	\draw [arrow_pointer] (vec3) -- (lstm3);
	
	% Arrows between LSTMs
	\node[right=.5 of lstm2] (lstm2_left_mid) {};
	\node[left=.5 of lstm3] (lstm2_right_mid) {};
	\draw [arrow_pointer] (lstm2) -- (lstm2_left_mid) node[pos=0.5, below=0.1]{$h_{l+1}$};
	\draw[dotted](lstm2_left_mid) -- (lstm2_right_mid);
	\draw [arrow_pointer] (lstm2_right_mid) -- (lstm3) node[pos=0.5, below=0.1]{$h_{r-2}$};
	
	% Softmax
	\node[rectangle, draw, above right= of lstm3] (softmax) {Softmax};
	\draw [arrow_pointer] (lstm3) -- (softmax) node[pos=0.5, below=0.1]{$h_{r-1}$};
	
	
	% Right Context
	\node[lstm_node, below right=of softmax](lstm4){LSTM};
	\draw [arrow_pointer] (lstm4) -- (softmax) node[pos=0.5, below=0.1]{$h_{l+1}$};
	
    \node[feature, below=1.5 of lstm4](feat13){};
    \node[feature, below=.2 of feat13](feat14){};
    \node[feature, above=.2 of feat13](feat12){};
	\node[vector, fit=(feat12)(feat13)(feat14)] (vec4) {};
	\node[below=.1 of vec4] (x4) {$w_{l+1}$};
	
	\node[feature, below=2 of feat13](target13){};
    \node[feature, below=.2 of target13](target14){};
    \node[feature, above=.2 of target13](target12){};
	\node[vector, fit=(target12)(target13)(target14)] (target_vec4) {};
	\node[below=.1 of target_vec4] (t4) {$t$};
	
	\draw [arrow_pointer] (vec4) -- (lstm4);
	
	\node[right=1 of feat13](dot2){$\dots$};
	
    \node[feature, right=of dot2](feat16){};
    \node[feature, below=.2 of feat16](feat17){};
    \node[feature, above=.2 of feat16](feat15){};
	\node[vector, fit=(feat15)(feat16)(feat17)] (vec5) {};
	\node[below=.1 of vec5] (x5) {$w_{r-1}$};
	
	\node[feature, below=2 of feat16](target16){};
    \node[feature, below=.2 of target16](target17){};
    \node[feature, above=.2 of target16](target15){};
	\node[vector, fit=(target15)(target16)(target17)] (target_vec5) {};
	\node[below=.1 of target_vec5] (t5) {$t$};
	
	% LSTM 5
	\node[lstm_node, above=1.5 of feat16](lstm5){LSTM};
	\draw [arrow_pointer] (vec5) -- (lstm5);
	
	% Arrows between LSTMs
	\node[right=.5 of lstm4] (lstm4_left_mid) {};
	\node[left=.5 of lstm5] (lstm4_right_mid) {};
	\draw [arrow_pointer] (lstm4_left_mid) -- (lstm4) node[pos=0.5, below=0.1]{$h_{l+2}$};
	\draw[dotted](lstm4_left_mid) -- (lstm4_right_mid);
	\draw [arrow_pointer] (lstm5) -- (lstm4_right_mid) node[pos=0.5, below=0.1]{$h_{r-1}$};
	
	\node[feature, right=1.2 of feat16](feat19){};
    \node[feature, below=.2 of feat19](feat20){};
    \node[feature, above=.2 of feat19](feat18){};
	\node[vector, fit=(feat18)(feat19)(feat20)] (vec6) {};
	\node[below=.1 of vec6] (x6) {$w_r$};
	
	\node[feature, below=2 of feat19](target19){};
    \node[feature, below=.2 of target19](target20){};
    \node[feature, above=.2 of target19](target18){};
	\node[vector, fit=(target18)(target19)(target20)] (target_vec6) {};
	\node[below=.1 of target_vec6] (t6) {$t$};
	
	% LSTM 6
	\node[lstm_node, above=1.5 of feat19](lstm6){LSTM};
	\draw [arrow_pointer] (vec6) -- (lstm6);
	\draw [arrow_pointer] (lstm6) -- (lstm5) node[pos=0.5, below=0.1]{$h_r$};
	
	\node[right=1 of feat19](dot3){$\dots$};
	
	\node[feature, right=of dot3](feat22){};
    \node[feature, below=.2 of feat22](feat23){};
    \node[feature, above=.2 of feat22](feat21){};
	\node[vector, fit=(feat21)(feat22)(feat23)] (vec7) {};
	\node[below=.1 of vec7] (x7) {$w_n$};
	
	\node[feature, below=2 of feat22](target22){};
    \node[feature, below=.2 of target22](target23){};
    \node[feature, above=.2 of target22](target21){};
	\node[vector, fit=(target21)(target22)(target23)] (target_vec7) {};
	\node[below=.1 of target_vec7] (t7) {$t$};
	
	% LSTM 7
	\node[lstm_node, above=1.5 of feat22](lstm7){LSTM};
	\draw [arrow_pointer] (vec7) -- (lstm7);
	
	% Arrows between LSTMs
	\node[right=.5 of lstm6] (lstm6_left_mid) {};
	\node[left=.5 of lstm7] (lstm6_right_mid) {};
	\draw [arrow_pointer] (lstm6_left_mid) -- (lstm6) node[pos=0.5, below=0.1]{$h_{r+1}$};
	\draw[dotted](lstm6_left_mid) -- (lstm6_right_mid);
	\draw [arrow_pointer] (lstm7) -- (lstm6_right_mid) node[pos=0.5, below=0.1]{$h_n$};
	
	% Left context arrows
	\node[below left=.1 of t0] (line0) {};
	\node[below right=.1 of t1] (line1) {};
	\draw [|-|] (line0) -- (line1)  node[pos=0.5, below=0.1]{Left Context};
	
	% Left Target context arrows
	\node[below left=.1 of t2] (line2) {};
	\node[below right=.1 of t3] (line3) {};
	\draw [|-|] (line2) -- (line3)  node[pos=0.5, below=0.1]{Target Context};
	
	% Right Target context arrows
	\node[below left=.1 of t4] (line4) {};
	\node[below right=.1 of t5] (line5) {};
	\draw [|-|] (line4) -- (line5)  node[pos=0.5, below=0.1]{Target Context};
	
	% Right context arrows
	\node[below left=.1 of t6] (line6) {};
	\node[below right=.1 of t7] (line7) {};
	\draw [|-|] (line6) -- (line7)  node[pos=0.5, below=0.1]{Right Context};
\end{tikzpicture}}